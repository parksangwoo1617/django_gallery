{% extends 'base.html' %} {% block title %}Django Gallery - 현대 미술의 새로운
공간{% endblock %} {% block extra_css %}
<style>
  .main-button {
    transition: all 0.3s ease;
    cursor: pointer;
    border: none !important;
  }

  .main-button:hover {
    transform: translateY(-10px) scale(1.05);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15) !important;
  }

  .main-button .card-body {
    padding: 3rem !important;
  }

  .main-button i {
    transition: all 0.3s ease;
  }

  .main-button:hover i {
    transform: scale(1.1);
  }
</style>
{% endblock %} {% block content %}
<!-- Main Features Section (모든 사용자) -->
<section class="py-5 bg-light">
  <div class="container">
    <!-- 섹션 헤더 -->
    <div class="row mb-5">
      <div class="col-12 text-center">
        <h2 class="display-5 fw-bold mb-3">갤러리 둘러보기</h2>
        <p class="lead text-muted">
          Django Gallery의 다양한 기능을 탐색해보세요
        </p>
      </div>
    </div>

    <!-- 메인 기능 버튼들 -->
    <div class="row justify-content-center">
      <!-- 작품 보기 -->
      <div class="col-lg-4 col-md-6 mb-4">
        <a href="/artworks/" class="text-decoration-none">
          <div
            class="card main-button bg-primary text-white h-100 shadow-lg"
            style="min-height: 300px"
          >
            <div
              class="card-body d-flex flex-column justify-content-center align-items-center text-center"
            >
              <i class="fas fa-palette display-1 mb-4"></i>
              <h4 class="card-title mb-4">작품 보기</h4>
              <div class="mt-auto">
                <i class="fas fa-arrow-right fa-2x"></i>
              </div>
            </div>
          </div>
        </a>
      </div>

      <!-- 작가 소개 -->
      <div class="col-lg-4 col-md-6 mb-4">
        <a href="/artists/" class="text-decoration-none">
          <div
            class="card main-button bg-success text-white h-100 shadow-lg"
            style="min-height: 300px"
          >
            <div
              class="card-body d-flex flex-column justify-content-center align-items-center text-center"
            >
              <i class="fas fa-users display-1 mb-4"></i>
              <h4 class="card-title mb-4">작가 소개</h4>
              <div class="mt-auto">
                <i class="fas fa-arrow-right fa-2x"></i>
              </div>
            </div>
          </div>
        </a>
      </div>

      <!-- 전시회 -->
      <div class="col-lg-4 col-md-6 mb-4">
        <a href="/exhibitions/" class="text-decoration-none">
          <div
            class="card main-button bg-info text-white h-100 shadow-lg"
            style="min-height: 300px"
          >
            <div
              class="card-body d-flex flex-column justify-content-center align-items-center text-center"
            >
              <i class="fas fa-calendar-alt display-1 mb-4"></i>
              <h4 class="card-title mb-4">전시회</h4>
              <div class="mt-auto">
                <i class="fas fa-arrow-right fa-2x"></i>
              </div>
            </div>
          </div>
        </a>
      </div>
    </div>
  </div>
</section>

<!-- Artist Application Section (로그인한 일반 사용자) -->
<section
  class="py-5 bg-success text-white auth-non-artist-only"
  style="display: none"
>
  <div class="container">
    <!-- 섹션 헤더 -->
    <div class="row mb-5">
      <div class="col-12 text-center">
        <h2 class="display-5 fw-bold mb-3">
          <i class="fas fa-star me-2"></i>작가로 활동해보세요!
        </h2>
        <p class="lead">
          갤러리의 정식 작가가 되어 작품을 전시하고 전시회를 개최할 수 있습니다
        </p>
      </div>
    </div>

    <!-- 작가 신청 버튼 -->
    <div class="row justify-content-center">
      <div class="col-lg-6 col-md-8 mb-4">
        <a href="/artists/apply/" class="text-decoration-none">
          <div
            class="card main-button bg-light text-dark h-100 shadow-lg"
            style="min-height: 280px"
          >
            <div
              class="card-body d-flex flex-column justify-content-center align-items-center text-center"
            >
              <i class="fas fa-user-plus display-1 mb-4 text-success"></i>
              <h3 class="card-title mb-3">작가 신청하기</h3>
              <div class="mt-auto">
                <i class="fas fa-arrow-right fa-2x text-success"></i>
              </div>
            </div>
          </div>
        </a>
      </div>
    </div>
  </div>
</section>

<!-- Guest Artist Application Info (게스트 사용자) -->
<section class="py-5 bg-info text-white guest-only">
  <div class="container">
    <!-- 섹션 헤더 -->
    <div class="row mb-5">
      <div class="col-12 text-center">
        <h2 class="display-5 fw-bold mb-3">
          <i class="fas fa-star me-2"></i>작가로 참여하고 싶으신가요?
        </h2>
        <p class="lead">
          회원가입 후 작가 신청을 통해 갤러리의 정식 작가가 될 수 있습니다
        </p>
      </div>
    </div>

    <!-- 인증 관련 버튼들 -->
    <div class="row justify-content-center">
      <!-- 회원가입 -->
      <div class="col-lg-5 col-md-6 mb-4">
        <a href="/accounts/signup/" class="text-decoration-none">
          <div
            class="card main-button bg-light text-dark h-100 shadow-lg"
            style="min-height: 280px"
          >
            <div
              class="card-body d-flex flex-column justify-content-center align-items-center text-center"
            >
              <i class="fas fa-user-plus display-1 mb-4 text-info"></i>
              <h4 class="card-title mb-3">회원가입</h4>
              <p class="card-text mb-4">
                Django Gallery에<br />
                새로운 계정을 만들어보세요
              </p>
              <div class="mt-auto">
                <i class="fas fa-arrow-right fa-2x text-info"></i>
              </div>
            </div>
          </div>
        </a>
      </div>

      <!-- 로그인 -->
      <div class="col-lg-5 col-md-6 mb-4">
        <a href="/accounts/login/" class="text-decoration-none">
          <div
            class="card main-button bg-light text-dark h-100 shadow-lg"
            style="min-height: 280px"
          >
            <div
              class="card-body d-flex flex-column justify-content-center align-items-center text-center"
            >
              <i class="fas fa-sign-in-alt display-1 mb-4 text-primary"></i>
              <h4 class="card-title mb-3">로그인</h4>
              <p class="card-text mb-4">
                기존 계정으로<br />
                갤러리에 접속하세요
              </p>
              <div class="mt-auto">
                <i class="fas fa-arrow-right fa-2x text-primary"></i>
              </div>
            </div>
          </div>
        </a>
      </div>
    </div>
  </div>
</section>

{% endblock %} {% block extra_js %}
<script>
  document.addEventListener("DOMContentLoaded", function () {
    // 로그인 상태 변경 시 작가 신청 상태도 확인
    setTimeout(checkAndUpdateArtistApplicationStatus, 500);
  });

  // 작가 신청 상태 확인 및 UI 업데이트
  async function checkAndUpdateArtistApplicationStatus() {
    // 로그인한 사용자만 확인
    if (!currentUser) return;

    try {
      const status = await api.checkArtistStatus();

      const authNonArtistSection = document.querySelector(
        ".auth-non-artist-only"
      );
      if (!authNonArtistSection) return;

      // 이미 작가인 경우 - 신청 섹션 숨김
      if (status.is_artist) {
        authNonArtistSection.style.display = "none";
        return;
      }

      // 신청 중인 경우 - 버튼 텍스트 변경
      if (status.has_application) {
        const button = authNonArtistSection.querySelector(
          'a[href="/artists/apply/"]'
        );
        const statusText = authNonArtistSection.querySelector(".col-lg-8 p");

        if (button && statusText) {
          switch (status.application_status) {
            case "pending":
              button.innerHTML = '<i class="fas fa-clock me-1"></i>심사 중';
              button.classList.remove("btn-light");
              button.classList.add("btn-warning");
              button.href = "#";
              button.onclick = (e) => {
                e.preventDefault();
                showMessage("작가 신청이 현재 심사 중입니다.", "info");
              };
              statusText.textContent =
                "작가 신청이 심사 중입니다. 결과를 기다려주세요.";
              break;

            case "rejected":
              button.innerHTML =
                '<i class="fas fa-redo me-1"></i>다시 신청하기';
              button.classList.remove("btn-light");
              button.classList.add("btn-outline-light");
              statusText.textContent =
                "이전 신청이 반려되었습니다. 다시 신청할 수 있습니다.";
              break;

            case "approved":
              // 승인된 경우는 위에서 is_artist로 처리되어야 하지만, 혹시 모르니 처리
              authNonArtistSection.style.display = "none";
              break;
          }
        }
      }
    } catch (error) {
      console.error("작가 신청 상태 확인 실패:", error);
    }
  }
</script>
{% endblock %}
